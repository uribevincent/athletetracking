<!--
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->

<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/paper-styles/typography.html">

<dom-module id="athlete-file">
  <template>
    <style include="shared-styles">
      :host {
        display: block;
      }

      span,
      input {
        @apply(--paper-font-body2);
      }
    </style>
    <h1  class="page-title" tabindex="-1">{{dbAthlete.name}}</h1>
    <paper-tabs selected="{{selected}}" >
    	<paper-tab>Informations</paper-tab>
    	<paper-tab>Résultats</paper-tab>
    	<paper-tab>Statistiques</paper-tab>
    </paper-tabs>
    	<iron-pages selected="{{selected}}">

    		<div>
    			<table>
	    			<tbody>
	    			  	<template is="dom-if" if="{{editEnabled}}">
		    				<tr>
			    				<td>Licence</td>
			    				<td>
			    					<paper-input value="{{dbAthlete.licenceNumber}}"></paper-input>
			    				</td>
			    			</tr>
		    				<tr>
			    				<td>Date de naissance</td>
			    				<td>
			    					<paper-input value="{{dbAthlete.birthDate}}"></paper-input>
			    				</td>
			    			</tr>
		    				<tr>
			    				<td>Taille</td>
			    				<td>
			    					<paper-input value="{{dbAthlete.height}}"></paper-input>
			    				</td>
			    			</tr>
		    				<tr>
			    				<td>Poids</td>
			    				<td>
			    					<paper-input value="{{dbAthlete.weight}}"></paper-input>
			    				</td>
			    			</tr>
		    				<tr>
			    				<td>VMA Estimée</td>
			    				<td>
			    					<paper-input value="{{dbAthlete.vma}}"></paper-input>
			    				</td>
			    			</tr>
		    				<tr>
			    				<td>Disponibilités</td>
			    				<td>
			    					<paper-input value="{{dbAthlete.availability}}"></paper-input>
			    				</td>
			    			</tr>
		    			</template>
		    			<template is="dom-if" if="{{!editEnabled}}">
		    				<tr>
			    				<td>Licence</td><td>{{dbAthlete.licenceNumber}}</td>
			    			</tr>
		    				<tr>
			    				<td>Age</td><td>{{dbAthlete.age}}</td>
			    			</tr>
		    				<tr>
			    				<td>Taille</td><td>{{dbAthlete.height}}</td>
			    			</tr>
		    				<tr>
			    				<td>Poids</td><td>{{dbAthlete.weight}}</td>
			    			</tr>
		    				<tr>
			    				<td>VMA Estimée</td><td>{{dbAthlete.vma}}</td>
			    			</tr>
		    				<tr>
			    				<td>Disponibilités</td><td>{{dbAthlete.availability}}</td>
			    			</tr>
		    			</template>
	    			</tbody>
    			</table>
    		</div>
    		<div>
    			<athlete-result athlete="{{athlete}}"></athlete-result>
    		</div>
    	<div>Statistiques</div>
    </iron-pages>
  </template>

  <script>
    (function() {
      'use strict';

      Polymer({
        is: 'athlete-file',

        properties: {
        	editEnabled: {
        		type: Boolean,
        		value: false
        	},

        	selected: {
				type: Number,
        		value: 0
        	},
          	athlete: {
				type: String,
				notify: true,
				reflectToAttribute: true,
				observer: "loadAthlete"
			},
			dbAthlete: {
			type: Object,
			notify: true,
			value: null
			}
        },
 		setAthlete: function(ath) {
        	this.dbAthlete = ath;
        },
        loadAthlete: function(val){
        	var me = this;
        	var ref = new Firebase(app.firebaseURL + '/athletes/' + val);
        	this.editEnabled = val === app.authData.uid;
        	ref.on('value', function(snapshot) {
        		var data = snapshot.val();
        		me.setAthlete(data);
        	});
        }


      });
    })();
  </script>
</dom-module>
