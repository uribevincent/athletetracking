<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/paper-styles/typography.html">

<dom-module id="training-book">
<template>
	<style include="shared-styles" is="custom-style">
		:host {
			display: block;
		}


	</style>

	<iron-pages selected="{{selectedPage}}">
	<div>
		<div class="container flex">
			<template is="dom-repeat" items="[[trainings]]" as="t" >
				<paper-material elevation="1">
					<h4>{{date}}-{{t.dayNumber}}</h4>
					<h5>{{t.type}}</h5>
					<p><i>Séance prévue : {{t.session_scheduled}}</i></p>
					<p>Séance réalisée : {{t.session_real}}</p>
					<p>Distance parcourue : {{t.distance}}</p>
					<p>Fréquence cardiaque moyenne : {{t.heartFrequency}}</p>
					<p>RPE : {{t.rpe}}</p>
					<p>Temps total : {{t.time}}</p>

					<p>{{t.comment}}</p>
				</paper-material>
			</template>

		</div>
	</div>

</template>

<script>
	(function() {
		'use strict';

		Polymer({
			is: 'training-book',

			properties: {
				selectedPage: {
					type: Number,
					value: 0,
				},
				trainings: {
					type: Array,
					notify: true
					//observer: '_renderCalendar'
				},
				date: {
					notify: true,
					observer: '_renderCalendar'
				},
				days: [],
				diff: 0
			},

			//observers: [ "computeCalendar(month)"],


			observers: [ "_updateCalendar(trainings.splices)"],


			_updateCalendar: function(changeRecord){
				if (changeRecord) {
					var me = this;
					_.each(changeRecord.indexSplices, function(s){
						s.removed.forEach(function(log) {
							console.log(log.$key + ' was removed');
						});
						for (var i=0; i<s.addedCount; i++) {
							var index = s.index + i;
							var log = s.object[index];
							console.log('log ' + log.$key + ' added at index ' + index);
							/*var dIndex = me.getDayIndex(log.dayNumber, this.diff);
							if(dIndex > -1){
								log.uid = log.$key;
								me.push("days.#" + dIndex + ".logs", log);
							}*/
						}
					}, this);
				}
			},
			_renderCalendar: function(d){

				/*this.days = new Array();
				if(d){
					var year = d.substring(0,4);
					var month = d.substring(5);
					var date = new Date(year, month, 0);
					var limit = parseInt(date.getDate());
					this.diff = this.getDaysToMonday(date);
					//add empty days
					for(var j = 0; j < this.diff; j++){
						this.push('days',null);
					}
					//Generate month calendar
					for(var i = 0; i < limit; i++){
						var o = {
							fullDate: new Date(year, month, i + 1),
							dayNumber: i + 1,
							logs: []
						};
						this.push('days',o);
					}
				}*/
			},
			saveEvent: function(e){

			},
			cancelEvent: function(){
				this.selectedPage = 0;
			}
		});
	})();
</script>
</dom-module>
